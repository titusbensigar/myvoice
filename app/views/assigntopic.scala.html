@(user : User)
@header("MyVoice",user)


        <div id="page-wrapper">
            <div class="row">
                <div class="col-lg-12">
                		<h1 class="page-header">Manage Topics</h1>
               			@if(flash.get("success")) {
		                    <div class="alert alert-success alert-dismissable">
			            	<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
			            		@flash.get("success")
			            	</div>
	            		} else {
	            			@if(flash.get("error")) {
		            			<div class="alert alert-danger alert-dismissable">
				            	<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
				            		@flash.get("error")
				            	</div>
			            	}
	            		}
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
            <div class="row">
				<div class="col-lg-12">
                    <div class="panel panel-primary">
                        <div class="panel-heading">
                            <i class="fa fa-file-text fa-fw"></i> Topics Panel
                        </div>
                        <!-- /.panel-heading -->
                        <div class="panel-body">
							<div class="table-responsive">
                                <table class="table table-striped table-bordered table-hover" id="topicTable">
                                    <thead>
                                        <tr>
                                            <th width="10%">#</th>
                                            <th width="40%">Title</th>
                                            <th width="30%">Created On</th>
                                           	<th width="20%">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        
                                    </tbody>
                                </table>
                            </div>
                            <!-- /.table-responsive -->
							
						</div>
					</div>
				</div>
				 
            <!-- /.row -->
        </div>
        
        
        <!-- /#page-wrapper -->

    </div>
    <script type="text/javascript">
   
    loadTable();
    
    var oTable;
    function loadTable() {
    	oTable = $('#topicTable').dataTable({
        		"bProcessing": true,
                "bServerSide": false,
                "sAjaxSource": "/topics.json",
                "sDom": "<'row-fluid'<'col-lg-6'l><'col-lg-6'f>r>t<'row-fluid'<'col-lg-6'i><'col-lg-6'p>>",
                "aoColumns": [
                     { "mData": "id" },
                     { "mData": "title" },
                     { "mData": "createdDate" },
                     { "mData": null }
                 ],
                 "aoColumnDefs": [     
             			{ "mRender": function(oObj) {
             					return '<a title="Assign Topic" href="javascript:assignusertopic(' + oObj.id +');" ><i class="fa fa-file-text fa-fw"></i></a>';
             				},
             				"bSortable": false,
             				"aTargets": [3]
             			}
             		],
             		"oLanguage": {
            			"sLengthMenu": "Show _MENU_ Topics",
            			"sEmptyTable": "No Topics Found.",
            			"sInfoEmpty": "",
            			"sProcessing": "Loading...",
            			"sClass": "dataTableContent"
            		},
    	});
    }
    
    function assignusertopic(topicId) {
    	var url = '/updateusertopic/' + topicId ;
        $.ajax({
    		type: "POST",
    		url: url,
    		dataType: "json"
    	}).done(function(data) {
    		if(data.status == 'success') {
	    		//show message
	    		bootbox.dialog({
				  message: data.msg,
				  title: "<i style=\"color:#60B08C;margin-top:5px;\" class=\"fa fa-check-circle fa-2x\"></i> Success",
				  buttons: {
				    main: {
				      label: "OK",
				      className: "btn-primary",
				      callback: function() {
				    	  window.location="/dashboard/@user.id"
				      }
				    }
				  }
				});
    		} else if(data.status == 'failed') {
    			bootbox.dialog({
  				  message: data.msg,
  				  title: "<i style=\"color:#b94a48;margin-top:5px;\" class=\"fa fa-times-circle fa-2x\"></i> Error",
  				  buttons: {
  					cancel: {
    				      label: "Cancel",
    				      className: "btn-default",
    				      callback: function() {
    				    	  window.location="/dashboard/@user.id"
    				      }
    				    },
  				    main: {
  				      label: "OK",
  				      className: "btn-primary",
  				      callback: function() {
  				    	deleteuser(id, false);
  				      }
  				    }
  				  }
  				});
    		} else {
    			bootbox.dialog({
  				  message: data.msg,
  				  title: "<i style=\"color:#b94a48;margin-top:5px;\" class=\"fa fa-times-circle fa-2x\"></i> Error",
  				  buttons: {
  				    main: {
  				      label: "OK",
  				      className: "btn-primary",
  				      callback: function() {
  				    	  window.location="/dashboard/@user.id"
  				      }
  				    }
  				  }
  				});
    		}
    	}).error(function(xhr, status) {

    	});
    }
     </script>
    
 
@footer()

